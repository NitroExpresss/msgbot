# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞–º–∏

–í —ç—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ –∫—Ä–∞—Ç–∫–æ –æ–ø–∏—Å–∞–Ω–∞ –º–æ–¥–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ –±–æ—Ç–∞

–°—É—â–µ—Å—Ç–≤—É–µ—Ç 2 —Ç–∏–ø–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥:

1.–û–±—Ä–∞—Ç–∫–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞. –ö–æ–≥–¥–∞ –º—ã –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–µ–∫—Å—Ç,
—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ —Ä–∞—Å–ø–æ–∑–Ω–æ–≤–∞–Ω–∏–µ –≤ DialogFlow –∏ —É–∂–µ –ø–æ –∏–º–µ–Ω–∏ –∏–Ω—Ç–µ—Ç–∞
–ø–æ–Ω–∏–º–∞–µ–º —Å–ª–µ–¥—É—é—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ

1.–ú—ã –ø–æ–ª—É—á–∞–µ–º callback —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —è–≤–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π

–ü–æ–ª—É—á–µ–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ (–∏–º—è –∏–Ω—Ç–µ–Ω—Ç–∞ –∏–ª–∏ callback) —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å–æ–º –≤ –∫–æ—Ç–æ—Ä—ã–π —Å—Ç—Ä–µ–º–∏—Ç—Å—è –¥–∏–∞–ª–æ–≥
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø–µ—Ä–µ—Ö–æ–¥–∞ –∏–∑ —Å—Ç–∞—Ç—É—Å–∞ –≤ —Å—Ç–∞—Ç—É—Å –∑–∞–Ω–∏–º–∞–µ–º—Å—è State Machine –∏–º–µ–Ω–Ω–æ –æ–Ω–∞ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –∏–∑ –æ–¥–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
–≤ –¥—Ä—É–≥–æ–π, –∞ –µ–µ callback-–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∏ –¥–µ–ª–∞—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

–í—Å—Ç–µ —Å—Ç–∞—É—Å—ã –ø—Ä–æ–ø–∏—Å–∞–Ω—ã –∫–∞–∫ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ `proto.States`

–ö–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑–≥–æ–æ–≤—Ä–∞ —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –ë–î –∏ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π (—Å–æ–æ–±—â–µ–Ω–∏–µ–º) –º—ã –∏–¥–µ–º –≤ –±–∞–∑—É –∏ –∑–∞–±–∏—Ä–∞–µ–º –µ–≥–æ —Å—Ç–∞—Ç—É—Å

*DialogFlow* - –Ω–∞ –≤—Ö–æ–¥–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è–µ—Ç—Å—è —Ç–µ–∫—É—â–∏–º —Å—Ç–∞—Ç—É—Å–æ–º –∑–∞–∫–∞–∑–∞. –ò–º—è –∏–Ω—Ç–µ–Ω—Ç–∞ - —Å—Ç–∞—Ç—É—Å –∫ –∫–æ—Ç–æ—Ä–æ–º—É
—Å—Ç—Ä–µ–º–∏—Ç—å—Å—è –¥–∏–∞–ª–æ–≥

## –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≤–µ—Ç–∫–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞

–ù–∞ –ø—Ä–∏–º–µ—Ä–µ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –≤–µ—Ç–∫–∏ –∑–∞–∫–∞–∑–∞ –µ–¥—ã

1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å –≤ `proto.States`. –í –º–æ–µ–º —Å–ª—É—á–∞–µ —è —Å–æ–∑–¥–∞–ª Food.Order.Create –∏ –ø—Ä–æ–ø–∏—Å–∞–ª –∑–Ω–∞—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –≤ 
—Ñ—É–Ω–∫—Ü–∏–∏ `initState()`, –∏–º–µ–Ω–Ω–æ —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ç —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –≤ –ë–î `States.Food.Order.Create = "food_order_create"`
1. –ü—Ä–æ–ø–∏—Å–∞—Ç—å —ç—Ç–æ—Ç –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å –≤ StateMachine - `handler\init_state_machine.go InitOrderStateFSM()`
(Src: - –∏–∑ –∫–∞–∫–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –º–æ–∂–Ω–æ –≤ –Ω–µ–≥–æ –ø–æ–ø–∞—Å—Ç—å). –ü–æ—Å–ª–µ –ø—Ä–æ–ø–∏—Å–∞–Ω–∏—è –¥–∏–∞–ª–æ–≥ —Å–º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤–æ –≤–Ω–æ–≤—å —Å–æ–∑–¥–∞–Ω–Ω—ã–π
—Å—Ç–∞—Ç—É—Å –µ—Å–ª–∏ –º—ã –ø—Ä–æ–ø–∏—à–µ–º CallBack –∏–ª–∏ —Å–æ–∑–¥–∞–¥–∏–º –∏–Ω—Ç–µ–Ω—Ç —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º 
1. –¢–µ–ø–µ—Ä—å –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ —á—Ç–æ –±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –≤ —ç—Ç–æ—Ç —Å—Ç–∞—Ç—É—Å –ø–µ—Ä–µ–π—Ç–∏. –í –º–æ–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ `welcome` —Å—Ç–∞—Ç—É—Å –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–ø–∏—Å–∞–Ω
—Ö–∞—Ä–¥–æ–∫–æ–º –≤ –Ω–∞—á–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ `h.getTextAnswer(msg)`. –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –Ω—É–∂–Ω–∞ –¥–ª—è –∫–∞–∫–æ–≥–æ —Ç–æ —Å—Ç–∞—Ç—É—Å–∞ —Ç–æ –µ–µ –Ω—É–∂–Ω–æ
–ø—Ä–æ–ø–∏—Å–∞—Ç—å –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `getAnswerButtons(msg *models.ChatMsgFull)` –≤ —Ñ–∞–π–ª–µ `buttons_handler.go`. –ù–∞–º –Ω—É–∂–Ω–æ –ø—Ä–æ–ø–∏—Å–∞—Ç—å 
—Ç–æ—Ç —Å—Ç–∞—Ç—É—Å –≤ –∫–æ—Ç–æ—Ä–æ–º –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—Å—è –∫–Ω–æ–ø–∫–∞ –≤—ã–∑—ã–≤–∞—é—â–∞—è –Ω–∞—à –Ω–æ–≤—ã–π —Å—Ç–µ–π—Ç. –°—Ç–µ–π—Ç –∑–∞–¥–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º `Data` —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `MsgButtons`
–≤ —Ö–µ–ª–ø–µ—Ä–∞—Ö. 
1.–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–¥–µ—Ç –ø—Ä–∏ –≤—ã–∑–æ–≤–µ —ç—Ç–æ–≥–æ callback-–∞, –Ω—É–∂–Ω–æ –µ–≥–æ –ø—Ä–æ–ø–∏—Å–∞—Ç—å –≤ —Ñ–∞–π–ª–µ `proto/answers.go` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ 
–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ `initAnswers()`. –í –º–∞–ø–µ `Answers.Intents[Constant] []string` –∫–ª—é—á–µ–º —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–≤–ª–µ–Ω–Ω—ã–π –Ω–∞ 1 —ç—Ç–∞–ø–µ
—Å—Ç–∞—Ç—É—Å —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö `Constant` –∞ –∑–Ω–∞—á–µ–Ω–∏–µ–º –º–∞—Å—Å–∏–≤ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∞.
```
var FoodOrderCreate = []string{
	"–ú–Ω–µ –∂–∞–ª—å üòî –Ω–æ —ç—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –µ—â–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. \n–ú—ã –ø–ª–∞–Ω–∏—Ä—É–µ–º –µ–≥–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å 15 –∞–≤–≥—É—Å—Ç–∞. –Ø –Ω–∞–ø–∏—à—É, –∫–∞–∫ –æ–Ω –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤.\n\n–ü–æ–∫–∞ –º–æ–∂–Ω–æ –∑–∞–∫–∞–∑–∞—Ç—å —Ç–∞–∫—Å–∏.",
	"—ç—ç—ç—ç—ç üò∂ –∑–∞–∫–∞–∑ –µ–¥—ã –µ—â–µ –Ω–µ –≤–∫–ª—é—á–∏–ª–∏.\n–û–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –≤ –Ω–∞—á–∞–ª–µ –∞–≤–≥—É—Å—Ç–∞, —è –ø—Ä–∏—à–ª—é —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–∞–∫ –æ–Ω –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤.\n–ê –ø–æ–∫–∞ –º–æ–∂–Ω–æ –∑–∞–∫–∞–∑–∞—Ç—å —Ç–∞–∫—Å–∏)",
}
...
//—Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –µ–¥—ã
for _, v := range FoodOrderCreate {
    Answers.Intents[States.Food.Order.Create] = append(Answers.Intents[States.Food.Order.Create], v)
}
```

—Ç–µ–ø–µ—Ä—å —Ñ—É–Ω–∫—Ü–∏—è `proto.GetIntentText(proto.Constant(msg.State))` –±—É–¥–µ—Ç –≤–æ–∑—Ä–∞—â–∞—Ç—å –Ω–∞—à —Ç–µ–∫—Å—Ç
1.–ß—Ç–æ –±—ã —Å–æ–∑–¥–∞—Ç—å –∫–Ω–æ–ø–∫–∏ –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –±–µ–∂–∏–º –≤ —Ñ—É–Ω–∫—Ü–∏—é `handler/button_handler.go - getAnswerButtons(msg)`. 
–∏ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π 
```
	case proto.States.Food.Order.Create.S():
		return proto.ButtonsSet{
			DisplayLocation: proto.Buttons.Display.Inline,
			Buttons: []proto.MsgKeyboardRows{
				{
					MsgButtons: []proto.MsgButton{{
							Text: proto.Buttons.Menu.CallTaxi.T(),
							Data: proto.Buttons.Menu.CallTaxi.D(),
						}}}}}
```

